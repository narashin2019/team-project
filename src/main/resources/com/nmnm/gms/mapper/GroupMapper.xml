<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.nmnm.gms.dao.GroupDao">

  <resultMap type="Group" id="GroupMap">
    <id column="group_no"  property="groupNo"/>
    <result column="group_name" property="groupName"/>
    <result column="group_info" property="groupInfo"/> 
    <result column="group_form" property="groupForm"/> 
    <result column="group_interest" property="groupInterest"/> 
    <result column="group_photo" property="groupPhoto"/>
    <result column="city" property="city"/>
    <result column="max_people_no" property="maxPeopleNo"/>
    <result column="create_date" property="createDate"/>
  </resultMap>
  
  <insert id="insert" parameterType="Group">
    insert into nm_group(
    group_name,
    group_info,
    group_form,
    group_interest,
    group_photo,
    city
    ) values(
      #{groupName},
      #{groupInfo},
      #{groupForm},
      #{groupInterest},
      #{groupPhoto},
      #{city})
  </insert>
  
  <select id="findAll" resultMap="GroupMap">
    select
      group_no,
      group_name,
      group_form,
      city
    from 
      nm_group
  </select>

  
  <select id="findByNo" resultMap="GroupMap" parameterType="int">
    select 
    group_photo,
    group_no,
    group_name,
    group_form,
    group_info,
    group_interest,
    city,
    create_date
    from 
      nm_group
    where 
      group_no=#{groupNo}
  </select>
  
  <update id="update" parameterType="Group">
    update nm_group
    <set>
      <if test="groupName != null and groupName != ''">group_name=#{groupName},</if>
      <if test="groupForm != null and groupForm != ''">group_form=#{groupForm},</if>
      <if test="groupInfo != null and groupInfo != ''">group_info=#{groupInfo},</if>
      <if test="groupPhoto != null and groupPhoto != ''">group_photo=#{groupPhoto},</if> 
      <if test="groupInterest != null and groupInterest != ''">group_interest=#{groupInterest},</if> 
      <if test="maxPeopleNo >= 0">max_people_no=#{maxPeopleNo},</if> 
      <if test="city != null and city != ''">city=#{city}</if>
    </set>
    where 
      group_no=#{groupNo}
  </update>
  
  <delete id="delete" parameterType="int">
    delete from nm_group
    where group_no=#{groupNo}
  </delete>
  
  <select id="findByKeyword" resultMap="GroupMap"
    parameterType="string">
        <bind name="keywordPattern" value="'%' + _parameter + '%'"/>
        select
       group_no,
      group_name,
      group_form,
      city
        from nm_group
        where     
            group_no like #{keywordPattern}
            or group_name like #{keywordPattern}
            or group_form like #{keywordPattern}
            or city  like #{keywordPattern}
    </select>
</mapper>